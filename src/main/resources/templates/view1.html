<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>view</title>


    <link rel="stylesheet" href="/css/bootstrap.css">
    <link rel="stylesheet" href="/css/animate.css">
    <link rel="stylesheet" href="/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/css/jquery-ui.min.css">


    <link rel="stylesheet" href="/fonts/ionicons/css/ionicons.min.css">
    <link rel="stylesheet" href="/fonts/fontawesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/fonts/flaticon/font/flaticon.css">

    <link rel="stylesheet" href="/css/element.css">
    <script src="/js/jquery-3.2.1.min.js"></script>
    <script src="/js/popper.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/owl.carousel.min.js"></script>
    <script src="/js/jquery.waypoints.min.js"></script>
    <script src="/js/jquery.stellar.min.js"></script>
    <script src="/js/vue.js"></script>
    <script src="/js/element.js"></script>
    <script src="/js/jqueryui.js"></script>



</head>

<body>

<div id="app">
    <el-container style="position: fixed;top:0;left: 0;height: 100%;width: 100%;">


        <el-main style="height: 100%;width: 100%;">
            <div id="viewbroad" style=" height:100%;position: fixed;overflow: auto;right: 0;width: 230px;z-index: 12">
                <el-row style="height: 150px">
                    <el-col  style="height: 100%;padding: 10px;" class="viewbox" data-id="0"><el-card class="box-card"    data-id="0" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="0"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="1"><el-card class="box-card"    data-id="1" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="1"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="2"><el-card class="box-card"    data-id="2" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="2"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="3"><el-card class="box-card"    data-id="3" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="3"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="4"><el-card class="0"    data-id="4" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="4"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="5"><el-card class="box-card"    data-id="5" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="5"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="6"><el-card class="box-card"    data-id="6" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="6"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="7"><el-card class="box-card"    data-id="7" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="7"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="8"><el-card class="box-card"    data-id="8" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="8"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="9"><el-card class="box-card"    data-id="9" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="9"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="10"><el-card class="box-card"    data-id="10" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="10"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="11"><el-card class="box-card"    data-id="11" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="11"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">

                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="12"><el-card class="box-card"    data-id="12" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="12"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col   style="height: 100%;padding: 10px;"  class="viewbox" data-id="13"><el-card class="box-card"    data-id="13" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="13"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="14"><el-card class="box-card"    data-id="14" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="14"></p></span></el-col>
                </el-row>
                <el-row style="height: 150px">
                    <el-col    style="height: 100%;padding: 10px;"  class="viewbox" data-id="15"><el-card class="box-card"    data-id="15" style="height: 100%;position: relative;"></el-card><span><p style="text-align: center" class="shebeiname" data-id="15"></p></span></el-col>
                </el-row>

            </div>
            <div class="" id="canvas" style="height: 100%;width: 100%;background: #fff3cd;position: fixed;left: 0;right: 230px;top:0;" >
                <el-row style="overflow: paged-y">

                </el-row>

                <div id="viewbody" style="position:relative;height: 100%;width: 100%">


                </div>
            </div>


        </el-main>
        <el-footer width="100%" height="150px" style="padding:0;z-index: 13">

            <el-menu
                    style="height: 100%;width: 100%;line-height: 150px;"
                    class="el-menu-demo"
                    mode="horizontal"
                    background-color="#545c64"
                    text-color="#fff"
                    active-text-color="#ffd04b"
            >


                <span slot="title" >关闭</span>


                <el-row  style="height: 100%;width: 100%"  >
                    <el-col :span="2">
                        <el-button round  @click="hide" style="margin: 20px;background: rgba(255,255,255,1)">关闭</el-button>
                    </el-col>
                    <el-col :span="2">
                        <el-button round  @click="qingkong" style="margin: 20px;background: rgba(255,255,255,1)">清空</el-button>
                    </el-col>
                    <el-col :span="2">
                        <el-button round  @click="huitui" style="margin: 20px;background: rgba(255,255,255,1)">撤销</el-button>

                    </el-col>
                    <el-col :span="2">
                        <el-button round  @click="shanchu" style="margin: 20px;background: rgba(255,255,255,1)">删除</el-button>

                    </el-col>


                    <el-col :span="16" style="overflow:auto;height: 100%;">
                        <img class="sucaiku" data-id="16" src="/view1iamges/rst_a01.png" style="height: 100px;width: 80px;margin: 10px" />
                        <img class="sucaiku" data-id="17" src="/view1iamges/rst_a02.png" style="height: 100px;width: 80px;margin: 10px" />
                        <img class="sucaiku" data-id="18" src="/view1iamges/rst_a03.png" style="height: 50px;width: 50px;margin: 10px" />
                        <img class="sucaiku" data-id="19" src="/view1iamges/rst_a04.png" style="height: 100px;width: 50px;margin: 10px" />
                        <img class="sucaiku" data-id="20" src="/view1iamges/rst_a05.png" style="height: 100px;width: 70px;margin: 10px" />
                        <img class="sucaiku" data-id="21" src="/view1iamges/rst_b01.png" style="height: 100px;width: 70px;margin: 10px" />
                        <img class="sucaiku" data-id="22" src="/view1iamges/rst_b02.png" style="height: 100px;width: 70px;margin: 10px" />
                        <img class="sucaiku" data-id="23" src="/view1iamges/rst_b03.png" style="height: 50px;width: 50px;margin: 10px" />
                        <img class="sucaiku" data-id="24" src="/view1iamges/rst_b04.png" style="height: 100px;width: 50px;margin: 10px" />


                    </el-col>



                </el-row>

            </el-menu>
        </el-footer>
    </el-container>
</div>
<script>
    var allshebei;
    var allstep;
    var delyuansu=false;



    var ele1;
    var angleX;
    var angleY;
    var parent;

    var btns=new Array();

    var vueobj=new Vue({
        el:"#app",
        methods: {
            hide:function () {
                window.location.href="http://127.0.0.1:8080/web/indextwo"
            },
            tiaozhuan:function () {
                window.location.href="http://127.0.0.1:8080/web/view1"
            },
            qingkong:function () {
                $("#viewbody").empty();
            },
            huitui:function () {
                if(btns.length>0){
                    btns[btns.length-1].remove();
                    while (btns[btns.length-1] ==1){
                        btns.pop();
                    }
                    btns.pop();


                }
            },
            shanchu:function () {

                if(delyuansu){
                    delyuansu=false;
                    $('.drag').css("border","");


                }else {
                    delyuansu=true;
                }
                if(delyuansu){
                    $('.drag').css("border","1px dashed #F00");
                }

            }


        }
    });



    $('.drag').click(function () {
        if(delyuansu){
            if(btns.length==1){btns.shift();}
            else {

            }
            btns[$(this).data("indexnum")]=1;
            console.log(btns)
            $(this).remove();
            $('.drag').css("border","");
            delyuansu=false;
        }


    });




    $('.sucaiku').click(function (event) {
        if(parent!=null){
            $('.sucaiku').each(function () {
                switch ( $(this).data("id")){
                    case 16:
                        $(this).attr("src","/view1iamges/rst_a01.png");
                        break;
                    case 17:
                        $(this).attr("src","/view1iamges/rst_a02.png");
                        break;
                    case 18:
                        $(this).attr("src","/view1iamges/rst_a03.png");
                        break;
                    case 19:
                        $(this).attr("src","/view1iamges/rst_a04.png");
                        break;
                    case 20:
                        $(this).attr("src","/view1iamges/rst_a05.png");
                        break;
                    case 21:
                        $(this).attr("src","/view1iamges/rst_b01.png");
                        break;
                    case 22:
                        $(this).attr("src","/view1iamges/rst_b02.png");
                        break;
                    case 23:
                        $(this).attr("src","/view1iamges/rst_b03.png");
                        break;
                    case 24:
                        $(this).attr("src","/view1iamges/rst_b04.png");
                        break;



                }
            });




        }

        parent=$(this);
        angleX=event.offsetX;
        angleY=event.offsetY;
        angle=$(this).data("id");
        var indexnum=btns.length;

        switch ($(this).data("id")) {

            case 16:
                ele1=$("<div class='drag' data-angleid='"+ +$(this).data("id")+"' data-index='"+indexnum+"' style='position: absolute;left:"+event.pageX+"px;top: "+event.pageY+"px; '><img style='height: 250px;width: 180px;'  src='/view1iamges/rst_a01.png'/></div>")
                parent.attr("src","/view1iamges/rst_a01h.png");

                break;
            case 17:
                ele1=$("<div class='drag' data-angleid='"+ +$(this).data("id")+"'  data-index='"+indexnum+"'' style='position: absolute;left:"+event.pageX+"px;top: "+event.pageY+"px; '><img style='height: 250px;width: 180px;'  src='/view1iamges/rst_a02.png'/></div>")
                parent.attr("src","/view1iamges/rst_a02h.png");
                break;
            case 18:
                ele1=$("<div class='drag' data-angleid='"+ +$(this).data("id")+"'   data-index='"+indexnum+"' style='position: absolute;left:"+event.pageX+"px;top: "+event.pageY+"px; '><img style='height: 50px;width: 50px;'  src='/view1iamges/rst_a03.png'/></div>")
                parent.attr("src","/view1iamges/rst_a03h.png");
                break;
            case 19:
                ele1=$("<div class='drag' data-angleid='"+ +$(this).data("id")+"'  data-index='"+indexnum+"' style='position: absolute;left:"+event.pageX+"px;top: "+event.pageY+"px; '><img style='height: 200px;width: 100px;'  src='/view1iamges/rst_a04.png'/></div>")
                parent.attr("src","/view1iamges/rst_a04h.png");
                break;
            case 20:
                ele1=$("<div class='drag' data-angleid='"+ +$(this).data("id")+"' data-index='"+indexnum+"' style='position: absolute;left:"+event.pageX+"px;top: "+event.pageY+"px; '><img style='height: 200px;width: 100px;'  src='/view1iamges/rst_a05.png'/></div>")
                parent.attr("src","/view1iamges/rst_a05h.png");
                break;
            case 21:
                ele1=$("<div class='drag' data-angleid='"+ +$(this).data("id")+"'  data-index='"+indexnum+"' style='position: absolute;left:"+event.pageX+"px;top: "+event.pageY+"px; '><img style='height: 250px;width: 180px;'  src='/view1iamges/rst_b01.png'/></div>")
                parent.attr("src","/view1iamges/rst_b01h.png");
                break;
            case 22:
                ele1=$("<div class='drag' data-angleid='"+ +$(this).data("id")+"'  data-index='"+indexnum+"' style='position: absolute;left:"+event.pageX+"px;top: "+event.pageY+"px; '><img style='height: 250px;width: 180px;'  src='/view1iamges/rst_b02.png'/></div>")
                parent.attr("src","/view1iamges/rst_b02h.png");
                break;
            case 23:
                ele1=$("<div class='drag' data-angleid='"+ +$(this).data("id")+"'  data-index='"+indexnum+"' style='position: absolute;left:"+event.pageX+"px;top: "+event.pageY+"px; '><img style='height: 50px;width: 50px;'  src='/view1iamges/rst_b03.png'/></div>")
                parent.attr("src","/view1iamges/rst_b03h.png");
                break;
            case 24:
                ele1=$("<div class='drag' data-angleid='"+ +$(this).data("id")+"'   data-index='"+indexnum+"' style='position: absolute;left:"+event.pageX+"px;top: "+event.pageY+"px; '><img style='height: 200px;width: 100px;'  src='/view1iamges/rst_b04.png'/></div>")
                parent.attr("src","/view1iamges/rst_b04h.png");
                break;



        }

        ele1.draggable({ containment: "#viewbody", scroll: false });

    });



    $("#viewbody").click(function (event) {
        if(ele1!=null){
            parent.css("border","");
            ele1.css("left",(event.pageX-angleX));
            ele1.css("top",(event.pageY-angleY));
            $('.sucaiku').each(function () {
                switch ( $(this).data("id")){
                    case 16:
                        $(this).attr("src","/view1iamges/rst_a01.png");
                        break;
                    case 17:
                        $(this).attr("src","/view1iamges/rst_a02.png");
                        break;
                    case 18:
                        $(this).attr("src","/view1iamges/rst_a03.png");
                        break;
                    case 19:
                        $(this).attr("src","/view1iamges/rst_a04.png");
                        break;
                    case 20:
                        $(this).attr("src","/view1iamges/rst_a05.png");
                        break;
                    case 21:
                        $(this).attr("src","/view1iamges/rst_b01.png");
                        break;
                    case 22:
                        $(this).attr("src","/view1iamges/rst_b02.png");
                        break;
                    case 23:
                        $(this).attr("src","/view1iamges/rst_b03.png");
                        break;
                    case 24:
                        $(this).attr("src","/view1iamges/rst_b04.png");
                        break;



                }
            });
            $("#viewbody").append(ele1);

            $('.drag').click(function () {
                if(delyuansu){
                    btns[$(this).data("indexnum")]=1;
                    $(this).remove();
                    $('.drag').css("border","");
                    delyuansu=false;
                }


            });

            btns.push(ele1);
            console.log(btns)

            ele1=null;
            parent=null;
            angleX=null;
            angleY=null;
        }
    });



    $.ajax({
        type: "GET",
        dataType: "JSON",
        url: "http://127.0.0.1:8080/app/allonlineshebei",
        async:false,
        contentType: "application/json",
        success:function (result) {
            allshebei=result;
            for(i=0;i<result.length;i++){
                $(".shebeiname").each(function () {
                    if($(this).data("id")== i){

                        $(this).text( result[i].name);
                    }
                });

                $(".box-card").each(function () {
                    if($(this).data("id")== i){

                        $(this).attr("pid",result[i].pid);
                    }
                });

            }
        }
    });
    $.ajax({
        type: "GET",
        dataType: "JSON",
        url: "http://127.0.0.1:8080/app/allsetp",
        contentType: "application/json",
        async:false,
        success:function (result) {
            allstep=result;
            for(i=0;i<result.length;i++){
                $(".box-card").each(function () {
                    if(result[i].pid==$(this).attr("pid")&&result[i].typeid==1){

                        switch (result[i].step) {
                            case 0:

                                switch (result[i].angle) {
                                    case 16:
                                        var ele=$("<div class='del' data-angleid='"+ result[i].angle+"' style='position: absolute;left:"+(result[i].x/5-25)+"px;top: "+ (result[i].y/5-18)+"px; '><img style='height: 50px;width: 36px;'  src='/view1iamges/rst_a01.png'/></div>")
                                        break;
                                    case 17:
                                        var ele=$("<div class='del' data-angleid='"+ result[i].angle+"' style='position: absolute;left:"+(result[i].x/5-25)+"px;top: "+ (result[i].y/5-18)+"px; '><img style='height: 50px;width: 36px;'  src='/view1iamges/rst_a02.png'/></div>")
                                        break;
                                    case 18:
                                        var ele=$("<div class='del' data-angleid='"+ result[i].angle+"' style='position: absolute;left:"+(result[i].x/5-5)+"px;top: "+ (result[i].y/5-5)+"px; '><img style='height: 10px;width: 10px;'  src='/view1iamges/rst_a03.png'/></div>")
                                        break;
                                    case 19:
                                        var ele=$("<div class='del' data-angleid='"+ result[i].angle+"' style='position: absolute;left:"+(result[i].x/5-20)+"px;top: "+ (result[i].y/5-10)+"px; '><img style='height: 40px;width: 20px;'  src='/view1iamges/rst_a04.png'/></div>")
                                        break;
                                    case 20:
                                        var ele=$("<div class='del' data-angleid='"+ result[i].angle+"' style='position: absolute;left:"+(result[i].x/5-20)+"px;top: "+ (result[i].y/5-10)+"px; '><img style='height: 40px;width: 20px;' src='/view1iamges/rst_a05.png'/></div>")
                                        break;
                                    case 21:
                                        var ele=$("<div class='del' data-angleid='"+ result[i].angle+"' style='position: absolute;left:"+(result[i].x/5-25)+"px;top: "+ (result[i].y/5-18)+"px; '><img style='height: 50px;width: 36px;'  src='/view1iamges/rst_b01.png'/></div>")
                                        break;
                                    case 22:
                                        var ele=$("<div class='del' data-angleid='"+ result[i].angle+"' style='position: absolute;left:"+(result[i].x/5-25)+"px;top: "+ (result[i].y/5-18)+"px; '><img style='height: 50px;width: 36px;'   src='/view1iamges/rst_b02.png'/></div>")
                                        break;
                                    case 23:
                                        var ele=$("<div class='del' data-angleid='"+ result[i].angle+"' style='position: absolute;left:"+(result[i].x/5-5)+"px;top: "+ (result[i].y/5-5)+"px; '><img style='height: 10px;width: 10px;'  src='/view1iamges/rst_b03.png'/></div>")
                                        break;
                                    case 24:
                                        var ele=$("<div class='del' data-angleid='"+ result[i].angle+"' style='position: absolute;left:"+(result[i].x/5-20)+"px;top: "+ (result[i].y/5-10)+"px; '><img style='height: 40px;width: 20px;'  src='/view1iamges/rst_b04.png'/></div>")
                                        break;





                                }
                                ele.attr("x",result[i].x)
                                ele.attr("y",result[i].y)

                                $(this).append(ele);




                                break;
                            case 1:


                                $('.del').each(function () {
                                    if( $(this).attr("x")==(result[i].x)&& $(this).attr("y") ==(result[i].y) && $(this).data("angleid")==result[i].angle){
                                        $(this).css("left",(result[i].gox/10+"px"));
                                        $(this).css("top",(result[i].goy/10+"px"));
                                        $(this).attr("x",result[i].gox);
                                        $(this).attr("y",result[i].goy);

                                        return false;

                                    }
                                });



                                break;
                            case 2:




                                break;
                            case 3:
                                $('.del').each(function () {
                                    console.log( result[i].x)
                                    console.log( result[i].y)

                                    console.log( $(this).css("left"))
                                    console.log( $(this).css("top"))

                                    if( $(this).css("left")==(viewstep[i].x+"px")&& $(this).css("top") ==(viewstep[i].y+"px") && $(this).data("angleid")==viewstep[i].angle){
                                        $(this).remove();
                                        return false;
                                    }
                                });
                                break;

                        }




                    }
                });



            }
        }
    });








    $(".viewbox").click(function () {
        var id=$(this).data("id");
        $('#viewbody').empty();
        var viewstep=new Array();


        for(i=0;i<allstep.length;i++){
            if(allshebei[id].pid ==allstep[i].pid  && allstep[i].typeid==1){
                viewstep.push(allstep[i]);
            }
        }
        for(i=0;i<viewstep.length;i++){

            var indexnum=btns.length;

            switch (viewstep[i].step) {
                case 0:

                    switch (viewstep[i].angle) {
                        case 16:
                            var ele=$("<div class='drag' data-angleid='"+ viewstep[i].angle+"'  data-index='"+indexnum+"' style='position: absolute;left:"+viewstep[i].x+"px;top: "+ viewstep[i].y+"px; '><img style='height: 250px;width: 180px;'  src='/view1iamges/rst_a01.png'/></div>")
                            break;
                        case 17:
                            ele1=$("<div class='drag' data-angleid='"+ viewstep[i].angle+"'  data-index='"+indexnum+"' style='position: absolute;left:"+viewstep[i].x+"px;top: "+ viewstep[i].y+"px;'><img style='height: 250px;width: 180px;'  src='/view1iamges/rst_a02.png'/></div>")
                            break;
                        case 18:
                            ele1=$("<div class='drag' data-angleid='"+ viewstep[i].angle+"'  data-index='"+indexnum+"' style='position: absolute;left:"+viewstep[i].x+"px;top: "+ viewstep[i].y+"px; '><img style='height: 50px;width: 50px;'  src='/view1iamges/rst_a03.png'/></div>")
                            break;
                        case 19:
                            ele1=$("<div class='drag' data-angleid='"+viewstep[i].angle+"'  data-index='"+indexnum+"' style='position: absolute;left:"+viewstep[i].x+"px;top: "+ viewstep[i].y+"px; '><img style='height: 200px;width: 100px;'  src='/view1iamges/rst_a04.png'/></div>")
                            break;
                        case 20:
                            ele1=$("<div class='drag' data-angleid='"+ viewstep[i].angle+"'  data-index='"+indexnum+"' style='position: absolute;left:"+viewstep[i].x+"px;top: "+ viewstep[i].y+"px; '><img style='height: 200px;width: 100px;'  src='/view1iamges/rst_a05.png'/></div>")
                            break;
                        case 21:
                            ele1=$("<div class='drag' data-angleid='"+ viewstep[i].angle+"'  data-index='"+indexnum+"' style='position: absolute;left:"+viewstep[i].x+"px;top: "+ viewstep[i].y+"px; '><img style='height: 250px;width: 180px;'  src='/view1iamges/rst_b01.png'/></div>")
                            break;
                        case 22:
                            ele1=$("<div class='drag' data-angleid='"+ viewstep[i].angle+"'  data-index='"+indexnum+"' style='position: absolute;left:"+viewstep[i].x+"px;top: "+ viewstep[i].y+"px; '><img style='height: 250px;width: 180px;'  src='/view1iamges/rst_b02.png'/></div>")
                            break;
                        case 23:
                            ele1=$("<div class='drag' data-angleid='"+ viewstep[i].angle+"'  data-index='"+indexnum+"' style='position: absolute;left:"+viewstep[i].x+"px;top: "+ viewstep[i].y+"px; '><img style='height: 50px;width: 50px;'  src='/view1iamges/rst_b03.png'/></div>")
                            break;
                        case 24:
                            ele1=$("<div class='drag' data-angleid='"+ viewstep[i].angle+"'  data-index='"+indexnum+"' style='position: absolute;left:"+viewstep[i].x+"px;top: "+ viewstep[i].y+"px; '><img style='height: 200px;width: 100px;'  src='/view1iamges/rst_b04.png'/></div>")
                            break;

                    }

                    $("#viewbody").append(ele);

                    $('.drag').click(function () {
                        if(delyuansu){
                            btns[$(this).data("indexnum")]=1;
                            $(this).remove();
                            $('.drag').css("border","");
                            delyuansu=false;
                        }


                    });
                    btns.push(ele);

                    ele.draggable({ containment: "#viewbody", scroll: false });



                    break;
                case 1:


                    $('.drag').each(function () {
                        if( $(this).css("left")==(viewstep[i].x+"px")&& $(this).css("top") ==(viewstep[i].y+"px") && $(this).data("angleid")==viewstep[i].angle){
                            $(this).css("left",(viewstep[i].gox+"px"));
                            $(this).css("top",(viewstep[i].goy+"px"));
                            return false;

                        }
                    });



                    break;
                case 2:




                    break;
                case 3:
                    $('.drag').each(function () {
                        console.log( viewstep[i].x)
                        console.log( viewstep[i].y)

                        console.log( $(this).css("left"))
                        console.log( $(this).css("top"))

                        if( $(this).css("left")==(viewstep[i].x+"px")&& $(this).css("top") ==(viewstep[i].y+"px") && $(this).data("angleid")==viewstep[i].angle){
                            $(this).remove();
                            return false;
                        }
                    });
                    break;

            }
        }



    });

    function dingshi(){


        $.ajax({
            type: "GET",
            dataType: "JSON",
            url: "http://127.0.0.1:8080/app/allsetp",
            contentType: "application/json",
            async:false,
            success:function (result) {
                $(".box-card").each(function () {
                    $(this).empty()
                });
                allstep=result
                for(i=0;i<result.length;i++){

                    $(".box-card").each(function () {

                        if(result[i].pid==$(this).attr("pid")&&result[i].typeid==1){


                            switch (result[i].step) {
                                case 0:

                                    switch (result[i].angle) {
                                        case 1:

                                            var ele=$("<div class='del' data-angleid='"+ result[i].angle+"' style='position: absolute;left:"+(result[i].x/10+10)+"px;top: "+ (result[i].y/10+10)+"px; '><img style='height: 20px;width: 20px;'  src='/images/img_1.jpg'/></div>");

                                            break;
                                    }
                                    ele.attr("x",result[i].x)
                                    ele.attr("y",result[i].y)
                                    $(this).append(ele);



                                    break;
                                case 1:


                                    $('.del').each(function () {
                                        if( $(this).attr("x")==(result[i].x)&& $(this).attr("y") ==(result[i].y) && $(this).data("angleid")==result[i].angle){
                                            $(this).css("left",(result[i].gox/10+"px"));
                                            $(this).css("top",(result[i].goy/10+"px"));
                                            $(this).attr("x",result[i].gox);
                                            $(this).attr("y",result[i].goy);



                                            return false;

                                        }
                                    });



                                    break;
                                case 2:




                                    break;
                                case 3:
                                    $('.del').each(function () {




                                        if( $(this).css("left")==(result[i].x+"px")&& $(this).css("top") ==(viewstep[i].y+"px") && $(this).data("angleid")==result[i].angle){
                                            $(this).remove();
                                            return false;
                                        }
                                    });
                                    break;

                            }




                        }
                    });



                }
            }
        });





    }
    setInterval("dingshi()",5000);

</script>

</body>
</html>